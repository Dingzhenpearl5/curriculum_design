<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>教学管理员仪表盘 - 成绩管理教学平台</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            background-color: #f8f9fa;
            padding-top: 56px; /* Height of fixed navbar */
        }
        .navbar-brand {
            font-weight: bold;
        }
        .main-content {
            padding: 20px 0;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
            border: none;
        }
        .dashboard-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            height: 100%;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
        }
        .dashboard-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #0d6efd;
        }
        .schedule-table th, .schedule-table td {
            text-align: center;
            vertical-align: middle;
            height: 60px;
        }
        .schedule-cell {
            background-color: #e3f2fd;
            border-radius: 4px;
            padding: 5px;
            font-size: 0.9em;
        }
        .sortable {
            cursor: pointer;
        }
        .sortable:hover {
            background-color: #f1f1f1;
        }
    </style>
</head>
<body>

<!-- Top Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top border-bottom border-secondary">
    <div class="container">
        <a class="navbar-brand" href="#" data-target="dashboard-section">
            <i class="bi bi-mortarboard-fill me-2"></i>教学管理
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-database"></i> 基础数据
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" data-target="class-section">班级管理</a></li>
                        <li><a class="dropdown-item" href="#" data-target="student-section">学生管理</a></li>
                        <li><a class="dropdown-item" href="#" data-target="course-section">课程管理</a></li>
                        <li><a class="dropdown-item" href="#" data-target="teacher-section">教师管理</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" data-target="plan-section">开课计划</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-target="score-section">
                        <i class="bi bi-check-circle"></i> 成绩审核
                    </a>
                </li>
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle"></i> 管理员
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#">个人设置</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#" onclick="logout()">退出登录</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container main-content">
    
    <!-- 0. 仪表盘 (Dashboard) -->
    <div id="dashboard-section" class="content-section">
        <div class="row mb-4">
            <div class="col-12">
                <h2 class="mb-3">欢迎回来，管理员</h2>
                <p class="text-muted">请选择一个模块开始工作</p>
            </div>
        </div>
        <div class="row g-4">
            <!-- Card 1: 班级管理 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="class-section">
                    <div class="card-body">
                        <i class="bi bi-people-fill dashboard-icon"></i>
                        <h5 class="card-title">班级管理</h5>
                        <p class="card-text text-muted">管理行政班级信息</p>
                    </div>
                </div>
            </div>
            <!-- Card 2: 学生管理 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="student-section">
                    <div class="card-body">
                        <i class="bi bi-person-badge dashboard-icon"></i>
                        <h5 class="card-title">学生管理</h5>
                        <p class="card-text text-muted">维护学生档案与信息</p>
                    </div>
                </div>
            </div>
            <!-- Card 3: 教师管理 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="teacher-section">
                    <div class="card-body">
                        <i class="bi bi-person-workspace dashboard-icon"></i>
                        <h5 class="card-title">教师管理</h5>
                        <p class="card-text text-muted">管理教师及授课资格</p>
                    </div>
                </div>
            </div>
            <!-- Card 4: 课程管理 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="course-section">
                    <div class="card-body">
                        <i class="bi bi-book-half dashboard-icon"></i>
                        <h5 class="card-title">课程管理</h5>
                        <p class="card-text text-muted">设置课程库及学分</p>
                    </div>
                </div>
            </div>
            <!-- Card 5: 开课计划 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="plan-section">
                    <div class="card-body">
                        <i class="bi bi-calendar-week dashboard-icon"></i>
                        <h5 class="card-title">开课计划</h5>
                        <p class="card-text text-muted">排课与学期教学安排</p>
                    </div>
                </div>
            </div>
            <!-- Card 6: 成绩审核 -->
            <div class="col-md-4 col-sm-6">
                <div class="card dashboard-card text-center p-4" data-target="score-section">
                    <div class="card-body">
                        <i class="bi bi-clipboard-check dashboard-icon"></i>
                        <h5 class="card-title">成绩审核</h5>
                        <p class="card-text text-muted">审核与发布期末成绩</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 1. 班级管理 -->
    <div id="class-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-people-fill me-2"></i>班级管理</h2>
            </div>
            <button class="btn btn-primary" onclick="openClassModal()">+ 新增班级</button>
        </div>
        <div class="card">
            <div class="card-body">
                <table class="table table-hover" id="class-table">
                    <thead>
                        <tr>
                            <th class="sortable" onclick="handleSort('class-table', 'id')">ID <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('class-table', 'name')">班级名称 <i class="bi bi-arrow-down-up"></i></th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 2. 学生管理 -->
    <div id="student-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-person-badge me-2"></i>学生管理</h2>
            </div>
            <div class="d-flex gap-2 align-items-start">
                <div class="input-group has-validation">
                    <input type="text" class="form-control" id="studentSearch" placeholder="搜索学生..." oninput="this.classList.remove('is-invalid')">
                    <button class="btn btn-outline-secondary" type="button" onclick="handleStudentSearch()">
                        <i class="bi bi-search"></i> 搜索
                    </button>
                    <div class="invalid-feedback">
                        请输入搜索关键词
                    </div>
                </div>
                <button class="btn btn-primary text-nowrap" onclick="openStudentModal()">+ 新增学生</button>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <table class="table table-hover" id="student-table">
                    <thead>
                        <tr>
                            <th class="sortable" onclick="handleSort('student-table', 'username')">学号 <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('student-table', 'name')">姓名 <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('student-table', 'gender')">性别 <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('student-table', 'className')">班级 <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('student-table', 'phone')">手机 <i class="bi bi-arrow-down-up"></i></th>
                            <th class="sortable" onclick="handleSort('student-table', 'region')">地区 <i class="bi bi-arrow-down-up"></i></th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 2.1 学生编辑 (个人中心风格) -->
    <div id="student-edit-section" class="content-section" style="display: none; background-color: #f8f9fa; min-height: calc(100vh - 56px);">
        <!-- Top Navigation Bar (Sub-nav) -->
        <div class="bg-white border-bottom px-4 d-flex justify-content-between align-items-center" style="height: 60px;">
            <div class="d-flex gap-4 h-100">
                <a href="#" class="nav-link-custom active d-flex align-items-center text-decoration-none px-2" style="border-bottom: 3px solid #fd7e14; color: #fd7e14; font-weight: 500;">基本信息</a>
                <a href="#" class="nav-link-custom d-flex align-items-center text-decoration-none px-2 text-secondary" style="border-bottom: 3px solid transparent;">修改密码</a>
            </div>
            <button class="btn btn-sm btn-outline-secondary" onclick="cancelEdit()">
                <i class="bi bi-x-lg"></i> 关闭
            </button>
        </div>

        <!-- Main Content Area -->
        <div class="container py-5">
            <div class="bg-white rounded shadow-sm mx-auto p-5" style="max-width: 800px;">
                <form id="studentEditForm">
                    <input type="hidden" id="editStudentId">
                    
                    <!-- Nickname -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end"><span class="text-danger me-1">*</span>昵称</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="editStudentUsername" placeholder="请输入昵称 (学号)">
                        </div>
                    </div>

                    <!-- Name -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end"><span class="text-danger me-1">*</span>姓名</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control bg-light" id="editStudentName" readonly>
                        </div>
                    </div>

                    <!-- Class (Added for context) -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end"><span class="text-danger me-1">*</span>班级</label>
                        <div class="col-sm-8">
                            <select class="form-select" id="editStudentClassId"></select>
                        </div>
                    </div>

                    <!-- Gender -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end"><span class="text-danger me-1">*</span>性别</label>
                        <div class="col-sm-8 d-flex align-items-center gap-4 pt-2">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="gender" id="genderMale" value="male" checked style="border-color: #fd7e14; background-color: #fd7e14;">
                                <label class="form-check-label" for="genderMale">男</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="gender" id="genderFemale" value="female">
                                <label class="form-check-label" for="genderFemale">女</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="gender" id="genderSecret" value="secret">
                                <label class="form-check-label" for="genderSecret">不公开</label>
                            </div>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end">邮箱</label>
                        <div class="col-sm-8 d-flex align-items-center">
                            <span class="text-secondary me-3">zhangsan@example.com</span>
                            <a href="#" class="text-decoration-none text-primary">修改邮箱</a>
                        </div>
                    </div>

                    <!-- Phone -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end">手机</label>
                        <div class="col-sm-8 d-flex align-items-center">
                            <span class="text-secondary me-3">138****8888</span>
                            <a href="#" class="text-decoration-none text-primary me-3">修改手机</a>
                            <a href="#" class="text-decoration-none text-success">解除绑定</a>
                        </div>
                    </div>

                    <!-- Birthday -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end">生日</label>
                        <div class="col-sm-8">
                            <input type="date" class="form-control text-secondary" style="max-width: 200px;">
                        </div>
                    </div>

                    <!-- Region -->
                    <div class="mb-4 row">
                        <label class="col-sm-2 col-form-label fw-bold text-end">地区</label>
                        <div class="col-sm-8">
                            <select class="form-select" style="max-width: 200px;">
                                <option value="" selected disabled>请选择省份</option>
                                <option value="beijing">北京</option>
                                <option value="shanghai">上海</option>
                                <option value="guangdong">广东</option>
                                <option value="zhejiang">浙江</option>
                            </select>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <div class="row mt-5">
                        <div class="col-sm-8 offset-sm-2 text-center">
                            <button type="button" class="btn text-white px-5 py-2" onclick="saveStudentProfile()" style="background-color: #fd7e14; border-radius: 4px;">保存</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 3. 课程管理 -->
    <div id="course-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-book-half me-2"></i>课程管理</h2>
            </div>
            <button class="btn btn-primary" onclick="openCourseModal()">+ 新增课程</button>
        </div>
        <div class="card">
            <div class="card-body">
                <table class="table table-hover" id="course-table">
                    <thead>
                        <tr>
                            <th>课程代码</th>
                            <th>课程名称</th>
                            <th>学分</th>
                            <th>所属院系</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 4. 教师管理 -->
    <div id="teacher-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-person-workspace me-2"></i>教师管理</h2>
            </div>
            <button class="btn btn-primary" onclick="openTeacherModal()">+ 新增教师</button>
        </div>
        <div class="card">
            <div class="card-body">
                <table class="table table-hover" id="teacher-table">
                    <thead>
                        <tr>
                            <th>工号</th>
                            <th>姓名</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 5. 开课计划 -->
    <div id="plan-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-calendar-week me-2"></i>开课计划管理</h2>
            </div>
            <button class="btn btn-primary" onclick="openPlanModal()">+ 新增开课计划</button>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">计划列表</div>
            <div class="card-body">
                <table class="table table-hover" id="plan-table">
                    <thead>
                        <tr>
                            <th>课程</th>
                            <th>授课教师</th>
                            <th>学期</th>
                            <th>教室</th>
                            <th>上课时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="card">
            <div class="card-header">本学期课表预览 (2024-2025-1)</div>
            <div class="card-body">
                <table class="table table-bordered schedule-table" id="schedule-table">
                    <thead>
                        <tr class="table-light">
                            <th>节次 / 星期</th>
                            <th>周一</th>
                            <th>周二</th>
                            <th>周三</th>
                            <th>周四</th>
                            <th>周五</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 6. 成绩审核 -->
    <div id="score-section" class="content-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary me-3" data-target="dashboard-section">
                    <i class="bi bi-arrow-left"></i> 返回
                </button>
                <h2 class="mb-0"><i class="bi bi-clipboard-check me-2"></i>成绩审核与发布</h2>
            </div>
            <button class="btn btn-outline-secondary" onclick="exportAllScores()">导出所有报表</button>
        </div>
        <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> 红色背景行表示数据异常（优秀率>60% 或 及格率<70%），请重点审核。
        </div>
        <div class="card">
            <div class="card-body">
                <table class="table table-hover align-middle" id="score-audit-table">
                    <thead>
                        <tr>
                            <th>课程名称</th>
                            <th>授课教师</th>
                            <th>学生人数</th>
                            <th>平均分</th>
                            <th>优秀率</th>
                            <th>及格率</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

</div>

<!-- Modals -->

<!-- Class Modal -->
<div class="modal fade" id="classModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="classModalLabel">编辑班级</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="classForm">
                    <input type="hidden" id="classId">
                    <div class="mb-3">
                        <label class="form-label" for="className">班级名称</label>
                        <input type="text" class="form-control" id="className" name="name" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveClass()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Student Modal -->
<div class="modal fade" id="studentModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="studentModalLabel">编辑学生</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="studentForm">
                    <input type="hidden" id="studentId">
                    <div class="mb-3">
                        <label class="form-label" for="studentUsername">学号 (Username)</label>
                        <input type="text" class="form-control" id="studentUsername" name="username" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="studentName">姓名</label>
                        <input type="text" class="form-control" id="studentName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="studentClassId">所属班级</label>
                        <select class="form-select" id="studentClassId" name="classId" required></select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveStudent()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Teacher Modal -->
<div class="modal fade" id="teacherModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="teacherModalLabel">编辑教师</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="teacherForm">
                    <input type="hidden" id="teacherId">
                    <div class="mb-3">
                        <label class="form-label" for="teacherUsername">工号 (Username)</label>
                        <input type="text" class="form-control" id="teacherUsername" name="username" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="teacherName">姓名</label>
                        <input type="text" class="form-control" id="teacherName" name="name" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveTeacher()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Course Modal -->
<div class="modal fade" id="courseModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="courseModalLabel">编辑课程</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="courseForm">
                    <input type="hidden" id="courseId">
                    <div class="mb-3">
                        <label class="form-label" for="courseCode">课程代码</label>
                        <input type="text" class="form-control" id="courseCode" name="code" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="courseName">课程名称</label>
                        <input type="text" class="form-control" id="courseName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="courseCredits">学分</label>
                        <input type="number" class="form-control" id="courseCredits" name="credits" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="courseDept">所属院系</label>
                        <input type="text" class="form-control" id="courseDept" name="department" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveCourse()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Plan Modal -->
<div class="modal fade" id="planModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="planModalLabel">编辑开课计划</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="planForm">
                    <input type="hidden" id="planId">
                    <div class="mb-3">
                        <label class="form-label" for="planCourseId">选择课程</label>
                        <select class="form-select" id="planCourseId" name="courseId" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="planTeacherId">授课教师</label>
                        <select class="form-select" id="planTeacherId" name="teacherId" required></select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="planSemester">学期</label>
                        <input type="text" class="form-control" id="planSemester" name="semester" value="2024-2025-1" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="planClassroom">教室</label>
                        <input type="text" class="form-control" id="planClassroom" name="classroom" required>
                    </div>
                    <div class="row mb-3">
                        <label class="form-label">上课时间</label>
                        <div class="col">
                            <select class="form-select" id="planDay" name="day">
                                <option value="周一">周一</option>
                                <option value="周二">周二</option>
                                <option value="周三">周三</option>
                                <option value="周四">周四</option>
                                <option value="周五">周五</option>
                            </select>
                        </div>
                        <div class="col">
                            <select class="form-select" id="planSlot" name="slot">
                                <option value="1-2节">1-2节</option>
                                <option value="3-4节">3-4节</option>
                                <option value="5-6节">5-6节</option>
                                <option value="7-8节">7-8节</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="savePlan()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Score Detail Modal -->
<div class="modal fade" id="scoreDetailModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">成绩明细</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3 d-flex justify-content-between">
                    <h6 id="scoreDetailTitle"></h6>
                    <span class="badge bg-warning text-dark" id="scoreDetailWarning" style="display:none">存在异常波动学生</span>
                </div>
                <table class="table table-sm table-bordered" id="score-detail-table">
                    <thead>
                        <tr>
                            <th>学号</th>
                            <th>姓名</th>
                            <th>平时成绩</th>
                            <th>期末成绩</th>
                            <th>总评</th>
                            <th>异常检测</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/data.js?v=2"></script>
<script src="js/admin.js?v=2"></script>
</body>
</html>
